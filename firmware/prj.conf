CONFIG_HWIFO=y

# CONFIG_WIFI_SCAN_NETWORKS=y

# Static WiFi credentials (OPEN)
CONFIG_WIFI_CREDENTIALS_STATIC_TYPE_OPEN=y
CONFIG_WIFI_CREDENTIALS_STATIC_SSID="ASK4 Wireless"

# Static WiFi credentials (PSK)
# Shell: wifi connect -s "MaxwellsiPhone" -k 1 --passphrase "<password>"
# CONFIG_WIFI_CREDENTIALS_STATIC=y
# CONFIG_WIFI_CREDENTIALS_STATIC_TYPE_PSK=y
# CONFIG_WIFI_CREDENTIALS_STATIC_SSID="MaxwellsiPhone"
# CONFIG_WIFI_CREDENTIALS_STATIC_PASSWORD="<password>"

# Static WiFi credentials (WPA3-SAE-HNP)
# Shell: # wifi connect -s "Levi's S24" -k 3 -w 2 --passphrase "<password>"
# CONFIG_WIFI_CREDENTIALS_STATIC=y
# CONFIG_WIFI_CREDENTIALS_STATIC_TYPE_SAE=y
# CONFIG_WIFI_CREDENTIALS_STATIC_SSID="Levi's S24"
# CONFIG_WIFI_CREDENTIALS_STATIC_PASSWORD="<password>"

# Static WiFi credentials (EAP-PEAP-MSCHAPV2)
# Shell: wifi connect -s "eduroam" -k 12 -I "<username>@ljmu.ac.uk" -P "<password>" -a "anonymous" -V 0
# CONFIG_WIFI_CREDENTIALS_STATIC=y
# CONFIG_WIFI_CREDENTIALS_STATIC_TYPE_EAP_PEAP_MSCHAPV2=y
# CONFIG_WIFI_CREDENTIALS_STATIC_SSID="eduroam"
# CONFIG_WIFI_CREDENTIALS_STATIC_EAP_IDENTITY="<username>@ljmu.ac.uk"
# CONFIG_WIFI_CREDENTIALS_STATIC_EAP_PASSWORD="<password>"

# logging: https://docs.zephyrproject.org/latest/services/logging/index.html
CONFIG_LOG=y
# CONFIG_LOG_MODE_IMMEDIATE=y
CONFIG_LOG_TIMESTAMP_USE_REALTIME=y
CONFIG_LOG_PRINTK=n
CONFIG_LOG_BUFFER_SIZE=2048
CONFIG_LOG_PROCESS_THREAD_STACK_SIZE=1024

CONFIG_EVENTS=y

# Increase stack memory to avoid crashes (at least 6144 for enterprise WiFi)
CONFIG_MAIN_STACK_SIZE=6144
CONFIG_NET_MGMT_EVENT_STACK_SIZE=4096
CONFIG_SYSTEM_WORKQUEUE_STACK_SIZE=6144

# Custom DNS servers (don't want surprises from the network)
CONFIG_DNS_SERVER_IP_ADDRESSES=y
CONFIG_DNS_SERVER1="1.1.1.1" # Cloudflare IPv4
CONFIG_DNS_SERVER2="2606:4700:4700::1111" # Cloudflare IPv6
CONFIG_DNS_SERVER3="8.8.8.8" # Google IPv4
CONFIG_DNS_SERVER4="2001:4860:4860::8888" # Google IPv6

# Enable custom hostname
CONFIG_NET_HOSTNAME_ENABLE=y
CONFIG_NET_HOSTNAME_UNIQUE=y
CONFIG_NET_HOSTNAME="korra-"

# Router is needed when resolving using external DNS servers
CONFIG_NET_CONFIG_NEED_IPV6_ROUTER=n

# printing of scan results puts pressure on queues in new locking
# design in net_mgmt. So, use a higher timeout for a crowded
# environment.
CONFIG_NET_MGMT_EVENT_QUEUE_TIMEOUT=5000
CONFIG_NET_MGMT_EVENT_QUEUE_SIZE=16

# Encryption and TLS
# These MBEDTLS configs are automatically added when CONFIG_WIFI_NM_WPA_SUPPLICANT=y
# We cannot enable it globally yet because builds on some boards fail.
# Other times, we just want to disable it because it can be a bit buggy.
# This is why they are here.
# Copied from external/zephyr/modules/hostap/Kconfig
# from WIFI_NM_WPA_SUPPLICANT_CRYPTO_ALT
CONFIG_MBEDTLS=y
CONFIG_MBEDTLS_CIPHER_MODE_CTR_ENABLED=y
CONFIG_MBEDTLS_CIPHER_MODE_CBC_ENABLED=y
CONFIG_MBEDTLS_CIPHER_AES_ENABLED=y
CONFIG_MBEDTLS_CIPHER_DES_ENABLED=y
CONFIG_MBEDTLS_MD5=y
CONFIG_MBEDTLS_SHA1=y
CONFIG_MBEDTLS_SHA384=y
CONFIG_MBEDTLS_ENTROPY_C=y
CONFIG_MBEDTLS_CIPHER=y
CONFIG_MBEDTLS_ECP_C=y
CONFIG_MBEDTLS_ECP_ALL_ENABLED=y
CONFIG_MBEDTLS_CMAC=y
CONFIG_MBEDTLS_PKCS5_C=y
CONFIG_MBEDTLS_PK_WRITE_C=y
CONFIG_MBEDTLS_ECDH_C=y
CONFIG_MBEDTLS_ECDSA_C=y
CONFIG_MBEDTLS_KEY_EXCHANGE_ECDHE_PSK_ENABLED=y
CONFIG_MBEDTLS_RSA_C=y
CONFIG_MBEDTLS_PKCS1_V15=y
CONFIG_MBEDTLS_PKCS1_V21=y
CONFIG_MBEDTLS_KEY_EXCHANGE_ECDHE_RSA_ENABLED=y
CONFIG_MBEDTLS_NIST_KW_C=y
CONFIG_MBEDTLS_DHM_C=y
CONFIG_MBEDTLS_HKDF_C=y
# from WIFI_NM_WPA_SUPPLICANT_CRYPTO_MBEDTLS_PSA
CONFIG_MBEDTLS_PSA_CRYPTO_C=y
CONFIG_MBEDTLS_USE_PSA_CRYPTO=y
CONFIG_PSA_WANT_ALG_ECDH=y
CONFIG_PSA_WANT_ALG_HMAC=y
CONFIG_PSA_WANT_ALG_CCM=y
CONFIG_PSA_WANT_ALG_CTR=y
CONFIG_PSA_WANT_ALG_MD5=y
CONFIG_PSA_WANT_ALG_SHA_1=y
CONFIG_PSA_WANT_ALG_SHA_256=y
CONFIG_PSA_WANT_ALG_SHA_224=y
CONFIG_PSA_WANT_ALG_SHA_384=y
CONFIG_PSA_WANT_ALG_SHA_512=y
CONFIG_PSA_WANT_ALG_PBKDF2_HMAC=y
CONFIG_PSA_WANT_ALG_CMAC=y
CONFIG_PSA_WANT_ALG_PBKDF2_AES_CMAC_PRF_128=y
CONFIG_PSA_WANT_KEY_TYPE_AES=y
CONFIG_PSA_WANT_KEY_TYPE_ECC_PUBLIC_KEY=y
CONFIG_PSA_WANT_KEY_TYPE_RSA_PUBLIC_KEY=y
# from WIFI_NM_WPA_SUPPLICANT_CRYPTO_ENTERPRISE
CONFIG_MBEDTLS_PEM_CERTIFICATE_FORMAT=y
CONFIG_MBEDTLS_SERVER_NAME_INDICATION=y
CONFIG_MBEDTLS_X509_CRL_PARSE_C=y
CONFIG_MBEDTLS_TLS_VERSION_1_2=y
# from WIFI_NM_WPA_SUPPLICANT_DPP
CONFIG_MBEDTLS_X509_CSR_WRITE_C=y
CONFIG_MBEDTLS_X509_CSR_PARSE_C=y
# from WIFI_NM_WPA_SUPPLICANT_CRYPTO_ENTERPRISE (further in the page)
CONFIG_MBEDTLS_SSL_MAX_CONTENT_LEN=16384
# For TLS and X.509 processing MbedTLS needs large heap size and using separate heap
# for it gives us more control over the heap size.
CONFIG_MBEDTLS_ENABLE_HEAP=y
CONFIG_MBEDTLS_HEAP_SIZE=50000
# CONFIG_MBEDTLS_HEAP_SIZE=69952
# CONFIG_MBEDTLS_HEAP_SIZE=100000
# These are for supporting device certificate support
CONFIG_PSA_WANT_ALG_ECDSA=y
CONFIG_PSA_WANT_KEY_TYPE_ECC_KEY_PAIR_IMPORT=y
CONFIG_PSA_WANT_KEY_TYPE_ECC_KEY_PAIR_EXPORT=y
CONFIG_PSA_WANT_KEY_TYPE_ECC_KEY_PAIR_GENERATE=y
CONFIG_PSA_WANT_KEY_TYPE_ECC_KEY_PAIR_DERIVE=y
CONFIG_MBEDTLS_KEY_EXCHANGE_ECDHE_ECDSA_ENABLED=y
CONFIG_MBEDTLS_X509_CRT_WRITE_C=y
# These add support for TLSv1.3
CONFIG_MBEDTLS_TLS_VERSION_1_3=y
CONFIG_PSA_WANT_ALG_HKDF_EXTRACT=y
CONFIG_PSA_WANT_ALG_HKDF_EXPAND=y

# EAP frames are large bytes, so
# - for efficiency, we increase the data size
# - need higher packet counts as default packet size is 128
CONFIG_NET_BUF_DATA_SIZE=1744
CONFIG_NET_PKT_TX_COUNT=36
CONFIG_NET_PKT_RX_COUNT=36
CONFIG_NET_BUF_TX_COUNT=40
CONFIG_NET_BUF_RX_COUNT=40

CONFIG_FLASH=y
CONFIG_FLASH_MAP=y
CONFIG_SETTINGS=y
CONFIG_NVS=y # using NVS instead of ZMS because it does not work with ESP32 yet
CONFIG_SETTINGS_NVS=y

CONFIG_TLS_CREDENTIALS=y
# CONFIG_TLS_CREDENTIALS_BACKEND_PROTECTED_STORAGE=y
CONFIG_TLS_MAX_CREDENTIALS_NUMBER=10

CONFIG_WIFI_CREDENTIALS=y
CONFIG_WIFI_CREDENTIALS_CONNECT_STORED=y
CONFIG_WIFI_CREDENTIALS_MAX_ENTRIES=4

CONFIG_MQTT_LIB=y
CONFIG_MQTT_LIB_TLS=y

# CONFIG_FLASH_LOG_LEVEL_DBG=y
# CONFIG_FLASH_LOG_LEVEL_INF=y
CONFIG_FLASH_LOG_LEVEL_WRN=y
# CONFIG_FLASH_LOG_LEVEL_ERR=y

# CONFIG_SETTINGS_LOG_LEVEL_DBG=y
# CONFIG_SETTINGS_LOG_LEVEL_INF=y
CONFIG_SETTINGS_LOG_LEVEL_WRN=y
# CONFIG_SETTINGS_LOG_LEVEL_ERR=y

# CONFIG_NVS_LOG_LEVEL_DBG=y
# CONFIG_NVS_LOG_LEVEL_INF=y
CONFIG_NVS_LOG_LEVEL_WRN=y
# CONFIG_NVS_LOG_LEVEL_ERR=y

# CONFIG_WIFI_CREDENTIALS_LOG_LEVEL_DBG=y
# CONFIG_WIFI_CREDENTIALS_LOG_LEVEL_INF=y
CONFIG_WIFI_CREDENTIALS_LOG_LEVEL_WRN=y
# CONFIG_WIFI_CREDENTIALS_LOG_LEVEL_ERR=y

# CONFIG_TLS_CREDENTIALS_LOG_LEVEL_DBG=y
# CONFIG_TLS_CREDENTIALS_LOG_LEVEL_INF=y
CONFIG_TLS_CREDENTIALS_LOG_LEVEL_WRN=y
# CONFIG_TLS_CREDENTIALS_LOG_LEVEL_ERR=y

# CONFIG_WIFI_LOG_LEVEL_DBG=y
# CONFIG_WIFI_LOG_LEVEL_INF=y
CONFIG_WIFI_LOG_LEVEL_WRN=y
# CONFIG_WIFI_LOG_LEVEL_ERR=y

# CONFIG_NET_IF_LOG_LEVEL_DBG=y
# CONFIG_NET_IF_LOG_LEVEL_INF=y
CONFIG_NET_IF_LOG_LEVEL_WRN=y
# CONFIG_NET_IF_LOG_LEVEL_ERR=y

# CONFIG_NET_MGMT_EVENT_LOG_LEVEL_DBG=y
# CONFIG_NET_MGMT_EVENT_LOG_LEVEL_INF=y
CONFIG_NET_MGMT_EVENT_LOG_LEVEL_WRN=y
# CONFIG_NET_MGMT_EVENT_LOG_LEVEL_ERR=y

# CONFIG_NET_DHCPV6_LOG_LEVEL_DBG=y
# CONFIG_NET_DHCPV6_LOG_LEVEL_INF=y
CONFIG_NET_DHCPV6_LOG_LEVEL_WRN=y
# CONFIG_NET_DHCPV6_LOG_LEVEL_ERR=y

# CONFIG_NET_SOCKETS_LOG_LEVEL_DBG=y
# CONFIG_NET_SOCKETS_LOG_LEVEL_INF=y
CONFIG_NET_SOCKETS_LOG_LEVEL_WRN=y
# CONFIG_NET_SOCKETS_LOG_LEVEL_ERR=y

# CONFIG_DNS_RESOLVER_LOG_LEVEL_DBG=y
# CONFIG_DNS_RESOLVER_LOG_LEVEL_INF=y
CONFIG_DNS_RESOLVER_LOG_LEVEL_WRN=y
# CONFIG_DNS_RESOLVER_LOG_LEVEL_ERR=y

# CONFIG_SNTP_LOG_LEVEL_DBG=y
# CONFIG_SNTP_LOG_LEVEL_INF=y
CONFIG_SNTP_LOG_LEVEL_WRN=y
# CONFIG_SNTP_LOG_LEVEL_ERR=y

# CONFIG_MQTT_LOG_LEVEL_DBG=y
# CONFIG_MQTT_LOG_LEVEL_INF=y
CONFIG_MQTT_LOG_LEVEL_WRN=y
# CONFIG_MQTT_LOG_LEVEL_ERR=y
